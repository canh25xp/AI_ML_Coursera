WEBVTT

1
00:00:00.000 --> 00:00:03.030
Khi bạn thực hiện truyền ngược 
trong mạng nơ-ron nhân tạo,

2
00:00:03.030 --> 00:00:07.620
bạn cần tính độ dốc hoặc đạo
 hàm của các hàm kích hoạt.

3
00:00:07.620 --> 00:00:09.990
Hãy cùng xem lựa chọn hàm kích hoạt

4
00:00:09.990 --> 00:00:14.565
của chúng tôi và cách tính
 độ dốc của các hàm này.

5
00:00:14.565 --> 00:00:18.225
Đây là hàm kích hoạt Sigmoid quen thuộc.

6
00:00:18.225 --> 00:00:20.835
Với bất kỳ giá trị đã cho nào của z,

7
00:00:20.835 --> 00:00:22.160
có thể là giá trị này của z.

8
00:00:22.160 --> 00:00:27.075
Hàm này sẽ có một số độ dốc hoặc
 một số đạo hàm tương ứng với,

9
00:00:27.075 --> 00:00:28.860
nếu bạn vẽ một đường nhỏ ở đây,

10
00:00:28.860 --> 00:00:32.460
chiều cao trên chiều rộng của
 tam giác dưới ở đây.

11
00:00:32.460 --> 00:00:36.630
Và nếu g của z là hàm sigmoid,

12
00:00:36.630 --> 00:00:39.930
thì độ dốc của hàm là d,

13
00:00:39.930 --> 00:00:41.655
dz g của z,

14
00:00:41.655 --> 00:00:48.685
và từ phép tính, chúng ta biết đó là
 độ dốc của g của x tại z.

15
00:00:48.685 --> 00:00:53.210
Nếu bạn quen với giải tích
 và biết cách lấy đạo hàm,

16
00:00:53.210 --> 00:00:56.060
nếu bạn lấy đạo hàm của hàm Sigmoid,

17
00:00:56.060 --> 00:00:59.915
thì nó bằng công thức này.

18
00:00:59.915 --> 00:01:02.930
Một lần nữa, tôi sẽ không 
thực hiện các bước giải tích,

19
00:01:02.930 --> 00:01:04.730
nhưng nếu bạn quen với giải tích,

20
00:01:04.730 --> 00:01:08.180
thì hãy cứ thoải mái đăng lên một video
 và cố gắng tự chứng minh điều này.

21
00:01:08.180 --> 00:01:12.545
Vì vậy, điều này tương đương với g của z,

22
00:01:12.545 --> 00:01:16.505
nhân (1 trừ g của z).

23
00:01:16.505 --> 00:01:21.465
Và hãy kiểm tra xem biểu
 thức này có nghĩa gì không.

24
00:01:21.465 --> 00:01:24.045
Đầu tiên, nếu z rất lớn,

25
00:01:24.045 --> 00:01:25.800
giả sử z bằng 10,

26
00:01:25.800 --> 00:01:30.315
thì g của z sẽ gần bằng 1,

27
00:01:30.315 --> 00:01:38.760
và vì vậy công thức ở bên trái cho chúng ta 
biết rằng d / dz g của z gần với g của z,

28
00:01:38.760 --> 00:01:43.210
bằng 1 nhân 1 trừ 1,

29
00:01:43.210 --> 00:01:46.575
do đó gần bằng 0.

30
00:01:46.575 --> 00:01:49.110
Điều này không chính xác vì khi z rất lớn,

31
00:01:49.110 --> 00:01:51.135
độ dốc gần bằng 0.

32
00:01:51.135 --> 00:01:53.955
Ngược lại, nếu z bằng -10,

33
00:01:53.955 --> 00:01:55.965
và khi đó,

34
00:01:55.965 --> 00:01:59.340
g của z gần bằng 0.

35
00:01:59.340 --> 00:02:04.560
Và công thức bên trái cho chúng ta biết
 d dz g của z sẽ gần với g của z,

36
00:02:04.560 --> 00:02:07.095
tức là 0 nhân 1 trừ 0.

37
00:02:07.095 --> 00:02:10.685
và nó cũng rất gần với 0, là chính xác.

38
00:02:10.685 --> 00:02:13.675
Cuối cùng, nếu z bằng 0,

39
00:02:13.675 --> 00:02:17.355
thì g của z bằng 1/2,

40
00:02:17.355 --> 00:02:19.275
đó là hàm sigmoid ở đây,

41
00:02:19.275 --> 00:02:26.620
và do đó đạo hàm bằng 1/2 nhân 1 trừ đi 1/2

42
00:02:26.620 --> 00:02:28.665
bằng 1/4,

43
00:02:28.665 --> 00:02:32.330
và đó chính là giá trị chính xác của

44
00:02:32.330 --> 00:02:36.140
đạo hàm hoặc độ dốc của 
hàm này khi z bằng 0.

45
00:02:36.140 --> 00:02:39.370
Cuối cùng, tôi muốn giới 
thiệu thêm một vài ký hiệu,

46
00:02:39.370 --> 00:02:42.895
đôi khi thay vì viết thế này,

47
00:02:42.895 --> 00:02:46.340
một cách viết nhanh cho đạo
 hàm là g phẩy của z.

48
00:02:46.340 --> 00:02:48.440
Và, g phẩy của z trong giải tích,

49
00:02:48.440 --> 00:02:52.250
dấu gạch nhỏ trên đầu được gọi là phẩy,

50
00:02:52.250 --> 00:02:55.970
vì vậy g phẩy của z là một cách
 viết nhanh cho phép tính

51
00:02:55.970 --> 00:03:01.250
đạo hàm của hàm g với biến đầu vào z.

52
00:03:01.250 --> 00:03:05.295
Trong một mạng nơ-ron nhân tạo,

53
00:03:05.295 --> 00:03:10.740
chúng ta có a bằng g của z,

54
00:03:10.740 --> 00:03:17.530
bằng số này, thì công thức này 
cũng rút gọn thành a nhân (1 trừ a).

55
00:03:17.530 --> 00:03:19.710
Đôi khi trong khi triển khai,

56
00:03:19.710 --> 00:03:25.355
bạn có thể thấy là g phẩy của z 
bằng a nhân (1 trừ a),

57
00:03:25.355 --> 00:03:30.330
và điều đó chỉ nói đến quan sát là g phẩy,

58
00:03:30.330 --> 00:03:31.710
có nghĩa là đạo hàm

59
00:03:31.710 --> 00:03:33.390
là bằng với điều này ở đây.

60
00:03:33.390 --> 00:03:38.980
Một ưu điểm của công thức này
 là nếu bạn đã tính giá trị cho a,

61
00:03:38.980 --> 00:03:40.705
thì bằng cách sử dụng biểu thức này,

62
00:03:40.705 --> 00:03:44.860
bạn cũng có thể nhanh chóng 
tính giá trị độ dốc cho g phẩy.

63
00:03:44.860 --> 00:03:47.980
Và đó là hàm kích hoạt sigmoid.

64
00:03:47.980 --> 00:03:51.220
Bây giờ chúng ta hãy xem
 hàm kích hoạt Tanh.

65
00:03:51.220 --> 00:03:53.285
Giống như những gì chúng
 ta đã có trước đây,

66
00:03:53.285 --> 00:03:57.330
định nghĩa của d dz g của z là

67
00:03:57.330 --> 00:04:04.225
độ dốc của g của z tại một điểm cụ thể của z,

68
00:04:04.225 --> 00:04:10.605
và nếu bạn nhìn vào công thức
 của hàm tiếp tuyến hyperbol,

69
00:04:10.605 --> 00:04:12.390
và nếu bạn biết giải tích, thì

70
00:04:12.390 --> 00:04:15.905
bạn có thể lấy đạo hàm và chỉ ra 
rằng điều này rút gọn thành

71
00:04:15.905 --> 00:04:21.230
công thức này và sử dụng

72
00:04:21.230 --> 00:04:27.050
cách viết nhanh chúng ta có trước 
đây, chúng ta gọi đây là g phẩy của z

73
00:04:27.050 --> 00:04:30.735
Và bạn có thể kiểm tra xem công 
thức này có nghĩa không nếu muốn.

74
00:04:30.735 --> 00:04:33.395
Ví dụ, nếu z bằng 10,

75
00:04:33.395 --> 00:04:37.545
Tanh của z sẽ rất gần với 1.

76
00:04:37.545 --> 00:04:42.330
Điều này đi từ cộng 1 đến trừ 1.

77
00:04:42.330 --> 00:04:45.030
Sau đó g phẩy của z,

78
00:04:45.030 --> 00:04:46.425
theo công thức này,

79
00:04:46.425 --> 00:04:48.300
sẽ là bằng 1 trừ 1 bình phương,

80
00:04:48.300 --> 00:04:50.115
do đó, rất gần với 0.

81
00:04:50.115 --> 00:04:52.190
Vậy nên, nếu z rất lớn, thì

82
00:04:52.190 --> 00:04:53.765
độ dốc gần bằng 0.

83
00:04:53.765 --> 00:04:56.375
Ngược lại, nếu z cực nhỏ,

84
00:04:56.375 --> 00:04:58.750
giả sử z bằng âm 10,

85
00:04:58.750 --> 00:05:02.715
thì Tanh của z sẽ gần âm 1,

86
00:05:02.715 --> 00:05:08.970
và vì vậy g phẩy của z sẽ gần 
bằng 1 trừ âm 1 bình phương.

87
00:05:08.970 --> 00:05:10.470
Và nó gần bằng 1 trừ 1,

88
00:05:10.470 --> 00:05:12.420
cũng gần bằng 0.

89
00:05:12.420 --> 00:05:14.775
Cuối cùng, nếu z bằng 0,

90
00:05:14.775 --> 00:05:18.844
thì Tanh của z bằng 0,

91
00:05:18.844 --> 00:05:21.630
và độ dốc bằng 1,

92
00:05:21.630 --> 00:05:25.740
đây là độ dốc khi z bằng 0.

93
00:05:25.740 --> 00:05:27.255
Vì vậy, tóm lại,

94
00:05:27.255 --> 00:05:29.955
nếu a bằng g của z,

95
00:05:29.955 --> 00:05:34.170
nếu a bằng Tanh này của z, thì đạo hàm,

96
00:05:34.170 --> 00:05:38.580
g phẩy của z, bằng 1 trừ một bình phương.

97
00:05:38.580 --> 00:05:41.990
g phẩy của z, bằng 1 trừ một bình phương.

98
00:05:41.990 --> 00:05:46.285
bạn có thể sử dụng công thức
 này để tính đạo hàm rất nhanh.

99
00:05:46.285 --> 00:05:48.740
Cuối cùng, đây là cách bạn
 tính các đạo hàm trong

100
00:05:48.740 --> 00:05:51.560
các hàm kích hoạt ReLU và Leaky ReLU.

101
00:05:51.560 --> 00:05:57.710
Với giá trị g của z bằng max( 0, z),

102
00:05:57.710 --> 00:06:00.840
do đó đạo hàm

103
00:06:00.840 --> 00:06:02.460
bằng 0,

104
00:06:02.460 --> 00:06:09.525
nếu z nhỏ hơn 0 và bằng 1 nếu z lớn hơn 0.

105
00:06:09.525 --> 00:06:16.300
Về lý thuyết thì nó không được
 xác định, nếu z bằng 0.

106
00:06:16.300 --> 00:06:19.399
Nhưng nếu bạn đang triển khai 
điều này trong phần mềm, thì

107
00:06:19.399 --> 00:06:21.960
có thể sẽ không đúng 100% về mặt toán học,

108
00:06:21.960 --> 00:06:26.630
nhưng nó sẽ hoạt động tốt nếu z bằng 0,

109
00:06:26.630 --> 00:06:28.960
nếu bạn đặt đạo hàm bằng 1.

110
00:06:28.960 --> 00:06:32.095
Nó luôn luôn phải bằng 0,
 và nó không thành vấn đề.

111
00:06:32.095 --> 00:06:34.540
Nếu bạn là một chuyên gia
 về tối ưu hóa, về lý thuyết,

112
00:06:34.540 --> 00:06:39.380
g phẩy sẽ trở thành sub-gradient 
của hàm kích hoạt g của z,

113
00:06:39.380 --> 00:06:41.795
đó là lý do tại sao gradient
 descent vẫn hoạt động.

114
00:06:41.795 --> 00:06:43.490
Nhưng bạn có thể coi nó là,

115
00:06:43.490 --> 00:06:47.505
xác suất của z bằng 0,000000

116
00:06:47.505 --> 00:06:51.080
thì nhỏ đến mức gần như
 không quan trọng là bạn

117
00:06:51.080 --> 00:06:54.245
đặt đạo hàm bằng bao nhiêu khi z bằng 0.

118
00:06:54.245 --> 00:06:59.090
Vì vậy, trong thực tế, đây là những gì 
mọi người thực hiện đạo hàm của z.

119
00:06:59.090 --> 00:07:04.645
Cuối cùng, nếu bạn đang huấn luyện một mạng
 nơ-ron nhân tạo với hàm kích hoạt Leaky ReLU,

120
00:07:04.645 --> 00:07:14.630
thì g của z sẽ là max (0,01 z, z), và do đó,

121
00:07:14.630 --> 00:07:20.300
g phẩy của z bằng 0,01 nếu z

122
00:07:20.300 --> 00:07:26.685
nhỏ hơn 0 và bằng 1 nếu z lớn hơn 0.

123
00:07:26.685 --> 00:07:31.250
Một lần nữa, về lý thuyết thì độ dốc không 
được xác định khi z chính xác bằng 0,

124
00:07:31.250 --> 00:07:34.250
nhưng nếu bạn triển khai một đoạn mã đặt

125
00:07:34.250 --> 00:07:38.585
đạo hàm hoặc đặt g phẩy bằng
 0,01 hoặc hoặc bằng 1,

126
00:07:38.585 --> 00:07:40.160
cách naò cũng được.

127
00:07:40.160 --> 00:07:42.610
Khi z chính xác bằng 0, mã của
 bạn sẽ hoạt động.

128
00:07:42.610 --> 00:07:44.430
Và theo các công thức này,

129
00:07:44.430 --> 00:07:49.355
bạn nên tính độ dốc hoặc đạo
 hàm của các hàm kích hoạt.

130
00:07:49.355 --> 00:07:51.260
Bây giờ, với những kiến thức cơ bản này,

131
00:07:51.260 --> 00:07:55.235
bạn đã sẵn sàng để học cách triển khai 
gradient descent cho mạng nơ-ron nhân tạo.

132
00:07:55.235 --> 00:07:57.330
Hãy cùng xem video tiếp theo để thấy điều đó.